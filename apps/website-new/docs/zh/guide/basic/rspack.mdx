# Rspack Plugin

:::info 注意
需要 Rspack 0.5.0 及以上版本
:::

- 使用 `Rspack` 构建工具的应用构建出满足 `Module Federation` 加载规范的模块
- 能够在构建插件里面使用别名消费微模块
- 能够设置模块的共享依赖配置，当加载模块的宿主环境已经存在对应依赖时将不会重复加载
- 当模块具备远程类型时将会自动把远程模块的类型下载下来消费
- 消费远程模块时将具备热更新能力

## 快速开始

### 安装

你可以通过如下的命令安装插件：

import { PackageManagerTabs } from '@theme';

<PackageManagerTabs
  command={{
    npm: 'npm add @module-federation/enhanced-rspack --save',
    yarn: 'yarn add @module-federation/enhanced-rspack --save',
    pnpm: 'pnpm add @module-federation/enhanced-rspack --save',
    bun: 'bun add @module-federation/enhanced-rspack --save',
  }}
/>

### 创建 Module Federation Config

创建 `module-federation.config.ts` 文件，内容如下：

```ts title='vmok.config.ts'
import { createVmokConfig } from '@module-federation/enhanced-rspack';

export default createVmokConfig({
  // 目前同一个 scm 目前只能绑定一个 Vmok 名称，请谨慎选择您的 Vmok name!!!
  // 若仅为体验使用，请使用 @demo 来作为空间
  // 正式项目请谨慎使用 scope，最好以团队+项目作为名称，并且将团队相关的组件都放置同一个 scope 下
  name: '@demo/host',
  remotes: {
    provider: '@demo/provider:http://localhost:2004/vmok-manifest.json',
  },
  exposes: {
    './Button': './src/components/Button.tsx',
  },
  shared: {
    react: {
      singleton: true,
    },
    'react-dom': {
      singleton: true,
    },
  },
});
```

### 注册插件

在 `Rspack` 中，你可以通过 `plugins` 配置项来添加插件：

```js title='webpack.config.js'
const { VmokPlugin } = require('@vmok/kit/rspack');
const vmokConfig = require('./vmok.config');

module.exports = {
  plugins: [new VmokPlugin(vmokConfig)],
};
```
